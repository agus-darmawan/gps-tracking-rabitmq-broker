# ============================================================================
# RabbitMQ Configuration for Vehicle Tracking System
# ============================================================================

# ============================================================================
# NETWORK LISTENERS
# ============================================================================
listeners.tcp.default = 5672

# ============================================================================
# MANAGEMENT PLUGIN
# ============================================================================
management.tcp.port = 15672
management.tcp.ip = 0.0.0.0

management.load_definitions = /etc/rabbitmq/definitions.json

# ============================================================================
# MQTT PLUGIN
# ============================================================================
mqtt.listeners.tcp.default = 1883
mqtt.allow_anonymous = false
mqtt.vhost = /
mqtt.exchange = vehicle.exchange
mqtt.subscription_ttl = 86400000
mqtt.prefetch = 10

# ============================================================================
# MEMORY MANAGEMENT
# ============================================================================
vm_memory_high_watermark.relative = 0.6
vm_memory_calculation_strategy = rss
vm_memory_high_watermark_paging_ratio = 0.5

# ============================================================================
# DISK SPACE MANAGEMENT
# ============================================================================
disk_free_limit.absolute = 2GB

# ============================================================================
# LOGGING - Enhanced for troubleshooting
# ============================================================================
log.file.level = info
log.console = true
log.console.level = info
log.connection.level = info
log.default.level = info

# Enable detailed management logging
log.file = /var/log/rabbitmq/rabbit.log
log.file.rotation.date = $D0
log.file.rotation.size = 10485760

# ============================================================================
# QUEUE SETTINGS
# ============================================================================
queue_master_locator = min-masters
default_queue_type = classic

# ============================================================================
# CONNECTION SETTINGS
# ============================================================================
heartbeat = 60
channel_max = 2047

# ============================================================================
# CONSUMER SETTINGS
# ============================================================================
consumer_timeout = 1800000

# ============================================================================
# QUEUE INDEX SETTINGS
# ============================================================================
queue_index_embed_msgs_below = 4096

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================
collect_statistics = coarse
collect_statistics_interval = 5000
background_gc_enabled = true
background_gc_target_interval = 60000

# ============================================================================
# SECURITY
# ============================================================================
loopback_users.guest = true

# ============================================================================
# TCP SETTINGS
# ============================================================================
tcp_listen_options.backlog = 128
tcp_listen_options.nodelay = true

# ============================================================================
# END OF CONFIGURATION
# ============================================================================